import{d as U,z as _,H as A,I as g,R as z,J as I,h as v,o as i,k,F as N,a as o,c as C,O as $,l as E,W as O,K as P,i as p,L as R,x as W,b as r,M as B,t as D,w as y,N as F,$ as S,C as L,P as M}from"./api.astro_astro_type_script_index_0_lang.CNbPyKW1.js";import{w as V}from"./DeleteSidebarListElement.vue.67KjR9Fr.js";import{q as T}from"./Form.vue.B2fYBk1n.js";import"./ViewLayoutSection.vue.DmuGjUg0.js";const q=U({__name:"CollectionServerForm",props:{collectionId:{default:""},serverUid:{default:""}},setup(w){const s=w,{activeWorkspaceCollections:d}=_(),{servers:m,serverMutators:c}=A(),u=[{label:"URL",key:"url",placeholder:"https://void.scalar.com",type:"text"},{label:"Description",key:"description",placeholder:"Production",type:"text"}],a=g(()=>{const t=d.value.find(e=>e.uid===s.collectionId);return m[t&&typeof s.serverUid=="string"&&s.serverUid==="default"?t.servers[0]??"":t?.servers.find(e=>e===s.serverUid)??""]}),b=g(()=>{var t,e;return(t=a.value)!=null&&t.url?((e=a.value.url.match(z.PATH))==null?void 0:e.map(l=>l.slice(1,-1)))??[]:[]});I(b,t=>{if(!a.value)return;const e=a.value.variables?{...a.value.variables}:{};Object.keys(e).forEach(l=>{t.includes(l)||delete e[l]}),t.forEach(l=>{e[l]||(e[l]={default:""})}),c.edit(a.value.uid,"variables",e)},{immediate:!0});const x=(t,e)=>{!d.value||!a.value||c.edit(a.value.uid,t,e)},h=(t,e)=>{if(!a.value)return;const l=a.value.variables||{};l[t]={...l[t],default:e},c.edit(a.value.uid,"variables",l)};return(t,e)=>{var l;return i(),v("div",{class:E(["divide-0.5 flex w-full flex-col divide-y rounded-b-lg text-sm",((l=a.value)==null?void 0:l.variables)&&"bg-b-1"])},[a.value?(i(),v(N,{key:0},[o(T,{data:a.value,onUpdate:x,options:u},null,8,["data"]),a.value.variables?(i(),C($,{key:0,variables:a.value.variables,"onUpdate:variable":h},null,8,["variables"])):k("",!0)],64)):k("",!0)],2)}}}),G={class:"flex h-full w-full flex-col gap-12 px-1.5 pt-8"},H={class:"flex flex-col gap-4"},Y={class:"rounded-lg border"},J={class:"bg-b-2 flex items-start justify-between rounded-t-lg py-1 pr-1 pl-3 text-sm"},K={key:1,class:"self-center"},X={class:"text-c-3 flex h-full items-center justify-center rounded-lg border p-4"},te=U({__name:"CollectionServers",setup(w){const{activeCollection:s}=_(),{servers:d,events:m,serverMutators:c}=A(),u=O(),a=P(null),b=g(()=>{var e;return!d||!((e=s.value)!=null&&e.servers)?[]:Object.values(d).filter(l=>{var f;return(f=s.value)==null?void 0:f.servers.includes(l.uid)})}),x=()=>m.commandPalette.emit({commandName:"Add Server"}),h=()=>{var e;!((e=s.value)!=null&&e.uid)||!a.value||(c.delete(a.value,s.value.uid),u.hide())},t=e=>{a.value=e,u.show()};return(e,l)=>{var f;return i(),v("div",G,[p("div",H,[l[2]||(l[2]=R('<div class="flex items-start justify-between gap-2"><div class="flex flex-col gap-2"><div class="flex h-8 items-center"><h3 class="font-bold">Servers</h3></div><p class="text-sm"> Add different base URLs for your API. You can use <code class="font-code text-c-2">{variables}</code> for dynamic parts. </p></div></div>',1)),(i(!0),v(N,null,W(b.value,(n,j)=>(i(),v("div",{key:n.uid},[p("div",Y,[p("div",J,[n.description?(i(),C(r(B),{key:0,value:n.description,class:"self-center"},null,8,["value"])):(i(),v("span",K,"Server "+D(j+1),1)),o(r(S),{class:"hover:bg-b-3 hover:text-c-1 h-fit p-1.25",variant:"ghost",onClick:Q=>t(n.uid)},{default:y(()=>[o(r(F),{class:"size-3.5"})]),_:2},1032,["onClick"])]),r(s)?(i(),C(q,{key:0,collectionId:r(s).uid,serverUid:n.uid},null,8,["collectionId","serverUid"])):k("",!0)])]))),128)),p("div",X,[o(r(S),{class:"hover:bg-b-2 hover:text-c-1 flex items-center gap-2",size:"sm",variant:"ghost",onClick:x},{default:y(()=>[o(r(L),{class:"inline-flex",icon:"Add",size:"sm",thickness:"1.5"}),l[1]||(l[1]=p("span",null,"Add Server",-1))]),_:1,__:[1]})])]),o(r(M),{size:"xxs",state:r(u),title:`Delete ${a.value?(f=r(d)[a.value])==null?void 0:f.url:"Server"}`},{default:y(()=>[o(V,{variableName:"Server",warningMessage:"Are you sure you want to delete this server? This action cannot be undone.",onClose:l[0]||(l[0]=n=>r(u).hide()),onDelete:h})]),_:1},8,["state","title"])])}}});export{te as default};
