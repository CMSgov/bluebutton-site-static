import{d as w,A as _,B as A,R as g,aW as N,D as R,c as v,o as i,a as k,U as j,j as o,k as C,aJ as $,z as B,a6 as D,f as E,b as p,bG as I,V,u as r,aK as W,y as O,T as y,aR as P,$ as U,a0 as T,ac as F}from"./api.astro_astro_type_script_index_0_lang.NHHQh0jI.js";import{w as G}from"./DeleteSidebarListElement.vue.DuguaE32.js";import{q as L}from"./Form.vue.B0O9Puv7.js";import"./ViewLayoutSection.vue.M-wu7EC7.js";const M=w({__name:"CollectionServerForm",props:{collectionId:{default:""},serverUid:{default:""}},setup(S){const s=S,{activeWorkspaceCollections:d}=_(),{servers:m,serverMutators:c}=A(),u=[{label:"URL",key:"url",placeholder:"https://void.scalar.com",type:"text"},{label:"Description",key:"description",placeholder:"Production",type:"text"}],l=g(()=>{const t=d.value.find(e=>e.uid===s.collectionId);return m[t&&typeof s.serverUid=="string"&&s.serverUid==="default"?t.servers[0]??"":t?.servers.find(e=>e===s.serverUid)??""]}),b=g(()=>{var t,e;return(t=l.value)!=null&&t.url?((e=l.value.url.match(N.PATH))==null?void 0:e.map(a=>a.slice(1,-1)))??[]:[]});R(b,t=>{if(!l.value)return;const e=l.value.variables?{...l.value.variables}:{};Object.keys(e).forEach(a=>{t.includes(a)||delete e[a]}),t.forEach(a=>{e[a]||(e[a]={default:""})}),c.edit(l.value.uid,"variables",e)},{immediate:!0});const x=(t,e)=>{!d.value||!l.value||c.edit(l.value.uid,t,e)},h=(t,e)=>{if(!l.value)return;const a=l.value.variables||{};a[t]={...a[t],default:e},c.edit(l.value.uid,"variables",a)};return(t,e)=>{var a;return i(),v("div",{class:B(["divide-0.5 flex w-full flex-col divide-y rounded-b-lg text-sm",((a=l.value)==null?void 0:a.variables)&&"bg-b-1"])},[l.value?(i(),v(j,{key:0},[o(L,{data:l.value,onUpdate:x,options:u},null,8,["data"]),l.value.variables?(i(),C($,{key:0,variables:l.value.variables,"onUpdate:variable":h},null,8,["variables"])):k("",!0)],64)):k("",!0)],2)}}}),q={class:"flex h-full w-full flex-col gap-12 px-1.5 pt-8"},Y={class:"flex flex-col gap-4"},H={class:"rounded-lg border"},J={class:"bg-b-2 flex items-start justify-between rounded-t-lg py-1 pr-1 pl-3 text-sm"},K={key:1,class:"self-center"},X={class:"text-c-3 flex h-full items-center justify-center rounded-lg border p-4"},te=w({__name:"CollectionServers",setup(S){const{activeCollection:s}=_(),{servers:d,events:m,serverMutators:c}=A(),u=D(),l=E(null),b=g(()=>{var e;return!d||!((e=s.value)!=null&&e.servers)?[]:Object.values(d).filter(a=>{var f;return(f=s.value)==null?void 0:f.servers.includes(a.uid)})}),x=()=>m.commandPalette.emit({commandName:"Add Server"}),h=()=>{var e;!((e=s.value)!=null&&e.uid)||!l.value||(c.delete(l.value,s.value.uid),u.hide())},t=e=>{l.value=e,u.show()};return(e,a)=>{var f;return i(),v("div",q,[p("div",Y,[a[2]||(a[2]=I('<div class="flex items-start justify-between gap-2"><div class="flex flex-col gap-2"><div class="flex h-8 items-center"><h3 class="font-bold">Servers</h3></div><p class="text-sm"> Add different base URLs for your API. You can use <code class="font-code text-c-2">{variables}</code> for dynamic parts. </p></div></div>',1)),(i(!0),v(j,null,V(b.value,(n,z)=>(i(),v("div",{key:n.uid},[p("div",H,[p("div",J,[n.description?(i(),C(r(W),{key:0,value:n.description,class:"self-center"},null,8,["value"])):(i(),v("span",K,"Server "+O(z+1),1)),o(r(U),{class:"hover:bg-b-3 hover:text-c-1 h-fit p-1.25",variant:"ghost",onClick:Q=>t(n.uid)},{default:y(()=>[o(r(P),{class:"size-3.5"})]),_:2},1032,["onClick"])]),r(s)?(i(),C(M,{key:0,collectionId:r(s).uid,serverUid:n.uid},null,8,["collectionId","serverUid"])):k("",!0)])]))),128)),p("div",X,[o(r(U),{class:"hover:bg-b-2 hover:text-c-1 flex items-center gap-2",size:"sm",variant:"ghost",onClick:x},{default:y(()=>[o(r(T),{class:"inline-flex",icon:"Add",size:"sm",thickness:"1.5"}),a[1]||(a[1]=p("span",null,"Add Server",-1))]),_:1,__:[1]})])]),o(r(F),{size:"xxs",state:r(u),title:`Delete ${l.value?(f=r(d)[l.value])==null?void 0:f.url:"Server"}`},{default:y(()=>[o(G,{variableName:"Server",warningMessage:"Are you sure you want to delete this server? This action cannot be undone.",onClose:a[0]||(a[0]=n=>r(u).hide()),onDelete:h})]),_:1},8,["state","title"])])}}});export{te as default};
